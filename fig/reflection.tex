\begin{lstlisting}[caption=Introspection using reflection,label=src:introspection]
|\begin{tikzpicture}[overlay]
\draw [->,thick] (2.8,-6.00) node [left] %
{\longremark{We are dealing with a \type{PtrValue} and according %
to the documentation\footnote{\texttt{godoc reflect}}:%
\begin{quote} %
\texttt{func (v *PtrValue) Elem() Value}\\%
Elem returns the value that v points to.\\%
If v is a nil pointer, Elem returns a nil Value.\\%
\end{quote} %
we can use \func{Elem()} to get the type the pointer points to. %
In this case \type{*reflect.StructValue}; %
}} %
to (2.8,-5.20);
\draw [->,thick] (3.8,-6.00) node [left] %
{\longremark{\func{Type()} returns \type{reflect.Type};}} %
to (3.8,-5.20);
\draw [->,thick] (5.4,-6.00) node [left] %
{\longremark{Internally  }} %
to (5.4,-5.20);
\draw [->,thick] (6.8,-6.00) node [left] %
{\longremark{main text can we do this in the code we have}} %
to (6.8,-5.20);
\draw [->,thick] (8.4,-6.00) node [left] %
{\longremark{We finally have the type we are after. Now we can use the %
methods defined for \type{*StructType}, like \func{Field(n)}, which %
returns the n$^{th}$ field of our struct as a \type{StructField};}} %
to (8.4,-5.20);
\draw [->,thick] (9.4,-6.00) node [left] %
{\longremark{The struct \type{StructField} has a \var{Tag} member which %
returns the tag-name as a string. So on the $0^{th}$ field we can %
unleash \func{.Tag} to access this name: \texttt{Field(0).Tag}. This %
\emph{finally} gives us \texttt{namestr}.}}%
to (9.4,-5.20);
\end{tikzpicture}|
type Person {
    name string "namestr"
    age  int
}

p1 := new(Person)   |\coderemark{\func{new} returns a pointer to Person}|
ShowTag(p1)	    |\coderemark{\func{ShowTag()} is now called with this pointer}|

func ShowTag(i interface{}) {
    switch t := reflect.NewValue(i).(type) { |\coderemark{Type assertion}|
    case *reflect.PtrValue: |\coderemark{\var{p1} is a pointer}|
	tag := t.Elem().Type().(*reflect.StructType).Field(0).Tag
	.
	.
\end{lstlisting}
